{"version":3,"sources":["webpack:///./src/views/order/OrderDetail.vue","webpack:///./src/views/order/OrderDetail.vue?b6db","webpack:///./src/views/order/OrderDetail.vue?4ddd","webpack:///./node_modules/core-js/modules/es.symbol.description.js"],"names":["class","aria-hidden","xlink:href","id","left","middle","payStatus","detail","order_no","created_at","status","showPayFn","type","block","handleConfirmOrder","plain","total","express_type","orderDetails","data","item","key","num","price","desc","goods","description","title","thumb","cover_url","closeable","show","showPay","close-on-click-overlay","position","style","border","column-num","src","ali_qr","name","components","NavBar","setup","route","state","orderId","init","query","then","res","console","log","loading","message","forbidClick","clear","mapping","1","2","3","4","5","sum","forEach","parseInt","parseFloat","qr_code_url","timer","setInterval","success","clearInterval","confirm","catch","render","__scopeId","$","DESCRIPTORS","global","has","isObject","defineProperty","f","copyConstructorProperties","NativeSymbol","Symbol","prototype","undefined","EmptyStringDescriptionStore","SymbolWrapper","arguments","length","String","result","this","symbolPrototype","constructor","symbolToString","toString","native","regexp","configurable","get","symbol","valueOf","string","call","slice","replace","forced"],"mappings":"kQAIQ,eAEM,OAFDA,MAAM,oBAAoBC,cAAY,Q,CACzC,eAAsC,OAAjCC,aAAW,oB,oBAGI,Q,GAGrBF,MAAM,c,GACJA,MAAM,a,EAAY,eAAmB,YAAb,UAAM,G,GAC9BA,MAAM,a,EAAY,eAAmB,YAAb,UAAM,G,GAC9BA,MAAM,a,EACT,eAAmB,YAAb,UAAM,G,iBAOX,O,iBASA,Q,GAEEG,GAAG,S,GACDH,MAAM,a,EAAY,eAAmB,YAAb,UAAM,G,GAC9BA,MAAM,a,EACT,eAAmB,YAAb,UAAM,G,iBAsBG,Y,+RAzDvB,eAgEM,YA/DJ,eAOU,QANSI,KAAI,GACnB,iBAEM,CAFN,MAIeC,OAAM,GAAC,iBAAI,C,YAG9B,eAqDM,MArDN,EAqDM,CApDJ,eAA+D,MAA/D,EAA+D,CAAxC,E,8BAAsB,EAAAC,WAAS,KACtD,eAAqE,MAArE,EAAqE,CAA9C,E,8BAAsB,EAAAC,OAAOC,UAAQ,KAC5D,eAEM,MAFN,EAEM,CADJ,E,8BAAsB,EAAAD,OAAOE,YAAU,KAGpB,IAAb,EAAAF,OAAOG,Q,iBADf,eAMC,G,MAJE,QAAO,EAAAC,UACRC,KAAK,UACLC,MAAA,I,YACC,iBAAG,C,iDAGe,IAAb,EAAAN,OAAOG,Q,iBADf,eAQC,G,MANE,QAAO,EAAAI,mBACRC,MAAA,GACAH,KAAK,UACLC,MAAA,GACAV,GAAG,e,YACF,iBAAI,C,iDAEP,eAKM,MALN,EAKM,CAJJ,eAA+D,MAA/D,EAA+D,CAAxC,E,eAAmB,IAAC,eAAG,EAAAa,OAAQ,MAAG,KACzD,eAEM,MAFN,EAEM,CADJ,E,8BAAsB,EAAAT,OAAOU,cAAY,Q,mBAI7C,eAQE,2BAPe,EAAAV,OAAOW,aAAaC,MAAI,SAAhCC,G,wBADT,eAQE,GANCC,IAAKD,EAAKjB,GACVmB,IAAKF,EAAKE,IACVC,MAAOH,EAAKG,MACZC,KAAMJ,EAAKK,MAAMC,YACjBC,MAAOP,EAAKK,MAAME,MAClBC,MAAOR,EAAKK,MAAMI,W,wDAGrB,eAaY,GAZVC,UAAA,GACQC,KAAM,EAAAC,Q,+CAAA,EAAAA,QAAO,IACpBC,0BAAwB,EACzBC,SAAS,SACRC,MAAO,gB,YAER,iBAKW,CALX,eAKW,GALAC,QAAQ,EAAQC,aAAY,G,YACrC,iBAGgB,CAHhB,eAGgB,Q,WAHD,iBAEb,C,EAAA,eAA2B,GAAfC,IAAK,EAAAC,QAAM,oB,wJAmBpB,GACbC,KAAM,cACNC,WAAY,CAAEC,SAAA,MACdC,MAHa,WAIX,IAAMC,EAAQ,iBAERC,GADS,iBACD,eAAS,CACrBC,QAAS,GACTvC,OAAQ,CACNW,aAAc,CACZC,KAAM,IAERT,OAAQ,EACRF,SAAU,GACVC,WAAY,GACZQ,aAAc,IAEhBe,SAAS,EACTO,OAAQ,MAEJQ,EAAO,WAAM,IACT5C,EAAOyC,EAAMI,MAAb7C,GACR0C,EAAMC,QAAU3C,EAChB,eAAeA,GAAI8C,MAAK,SAACC,GACvBC,QAAQC,IAAIF,GACZL,EAAMtC,OAAS2C,MAGnB,gBAAU,WACR,OAAMG,QAAQ,CAAEC,QAAS,MAAOC,aAAa,IAC7CR,IACA,OAAMS,WAER,IAAMlD,EAAY,gBAAS,WACzB,IAAMmD,EAAU,CACdC,EAAG,MACHC,EAAG,OACHC,EAAG,MACHC,EAAG,QACHC,EAAG,OAEL,OAAOL,EAAQZ,EAAMtC,OAAOG,WAGxBM,EAAQ,gBAAS,WACrB,IAAI+C,EAAM,EAIV,OAHAlB,EAAMtC,OAAOW,aAAaC,KAAK6C,SAAQ,SAAC5C,GACtC2C,GAAOE,SAAS7C,EAAKE,KAAO4C,WAAW9C,EAAKK,MAAMF,UAE7CwC,KAEHpD,EAAY,WAChBkC,EAAMb,SAAU,EAChB,eAASa,EAAMC,QAAS,CAAElC,KAAM,WAAYqC,MAAK,SAACC,GAChDL,EAAMN,OAASW,EAAIiB,eAGrB,IAAMC,EAAQC,aAAY,WACxB,eAAexB,EAAMC,SAASG,MAAK,SAACC,GACtB,IAARA,IACF,OAAMoB,QAAQ,QACdzB,EAAMb,SAAU,EAChBuC,cAAcH,GACdrB,UAGH,MAGCjC,EAAqB,WACzB,OAAO0D,QAAQ,CAAE7C,MAAO,WAAYsB,MAAK,WACvC,eAAaJ,EAAMC,SAASG,MAAK,SAACC,GAC9B,OAAMoB,QAAQ,QACdvB,UAEH0B,OAAM,gBAKX,wCACK,eAAO5B,IADZ,IAEEvC,YACAU,QACAL,YACAG,yB,UC/JN,EAAO4D,OAASA,EAChB,EAAOC,UAAY,kBAEJ,gB,oCCRf,W,kCCGA,IAAIC,EAAI,EAAQ,QACZC,EAAc,EAAQ,QACtBC,EAAS,EAAQ,QACjBC,EAAM,EAAQ,QACdC,EAAW,EAAQ,QACnBC,EAAiB,EAAQ,QAAuCC,EAChEC,EAA4B,EAAQ,QAEpCC,EAAeN,EAAOO,OAE1B,GAAIR,GAAsC,mBAAhBO,MAAiC,gBAAiBA,EAAaE,iBAExDC,IAA/BH,IAAe1D,aACd,CACD,IAAI8D,EAA8B,GAE9BC,EAAgB,WAClB,IAAI/D,EAAcgE,UAAUC,OAAS,QAAsBJ,IAAjBG,UAAU,QAAmBH,EAAYK,OAAOF,UAAU,IAChGG,EAASC,gBAAgBL,EACzB,IAAIL,EAAa1D,QAED6D,IAAhB7D,EAA4B0D,IAAiBA,EAAa1D,GAE9D,MADoB,KAAhBA,IAAoB8D,EAA4BK,IAAU,GACvDA,GAETV,EAA0BM,EAAeL,GACzC,IAAIW,EAAkBN,EAAcH,UAAYF,EAAaE,UAC7DS,EAAgBC,YAAcP,EAE9B,IAAIQ,EAAiBF,EAAgBG,SACjCC,EAAyC,gBAAhCP,OAAOR,EAAa,SAC7BgB,EAAS,wBACbnB,EAAec,EAAiB,cAAe,CAC7CM,cAAc,EACdC,IAAK,WACH,IAAIC,EAASvB,EAASc,MAAQA,KAAKU,UAAYV,KAC3CW,EAASR,EAAeS,KAAKH,GACjC,GAAIxB,EAAIS,EAA6Be,GAAS,MAAO,GACrD,IAAI/E,EAAO2E,EAASM,EAAOE,MAAM,GAAI,GAAKF,EAAOG,QAAQR,EAAQ,MACjE,MAAgB,KAAT5E,OAAc+D,EAAY/D,KAIrCoD,EAAE,CAAEE,QAAQ,EAAM+B,QAAQ,GAAQ,CAChCxB,OAAQI","file":"js/chunk-b4a3f682.a7e5a5d1.js","sourcesContent":[" <template>\r\n  <div>\r\n    <nav-bar>\r\n      <template v-slot:left>\r\n        <svg class=\"icon tab-bar-icon\" aria-hidden=\"true\">\r\n          <use xlink:href=\"#icon-jiantou\"></use>\r\n        </svg>\r\n      </template>\r\n      <template v-slot:middle>订单详情</template>\r\n    </nav-bar>\r\n\r\n    <div class=\"detail-box\">\r\n      <div class=\"text-line\"><span>订单状态： </span>{{ payStatus }}</div>\r\n      <div class=\"text-line\"><span>订单编号： </span>{{ detail.order_no }}</div>\r\n      <div class=\"text-line\">\r\n        <span>下单时间： </span>{{ detail.created_at }}\r\n      </div>\r\n      <van-button\r\n        v-if=\"detail.status === 1\"\r\n        @click=\"showPayFn\"\r\n        type=\"primary\"\r\n        block\r\n        >去支付</van-button\r\n      >\r\n      <van-button\r\n        v-if=\"detail.status === 2\"\r\n        @click=\"handleConfirmOrder\"\r\n        plain\r\n        type=\"primary\"\r\n        block\r\n        id=\"confirm-btn\"\r\n        >确认订单</van-button\r\n      >\r\n      <div id=\"order\">\r\n        <div class=\"text-line\"><span>商品金额： </span>￥{{ total }}.00</div>\r\n        <div class=\"text-line\">\r\n          <span>配送方式： </span>{{ detail.express_type }}\r\n        </div>\r\n      </div>\r\n\r\n      <van-card\r\n        v-for=\"item of detail.orderDetails.data\"\r\n        :key=\"item.id\"\r\n        :num=\"item.num\"\r\n        :price=\"item.price\"\r\n        :desc=\"item.goods.description\"\r\n        :title=\"item.goods.title\"\r\n        :thumb=\"item.goods.cover_url\"\r\n      />\r\n\r\n      <van-popup\r\n        closeable\r\n        v-model:show=\"showPay\"\r\n        :close-on-click-overlay=\"false\"\r\n        position=\"bottom\"\r\n        :style=\"{ height: '40%' }\"\r\n      >\r\n        <van-grid :border=\"false\" :column-num=\"1\">\r\n          <van-grid-item>\r\n            支付宝二维码\r\n            <van-image :src=\"ali_qr\" />\r\n          </van-grid-item>\r\n        </van-grid>\r\n      </van-popup>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n <script>\r\nimport NavBar from \"components/common/navbar/NavBar.vue\";\r\nimport {\r\n  getOrderDetail,\r\n  payOrder,\r\n  payOrderStatus,\r\n  confirmOrder,\r\n} from \"network/order\";\r\nimport { toRefs, onMounted, reactive, computed } from \"vue\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\nimport { Dialog, Toast } from \"vant\";\r\nexport default {\r\n  name: \"OrderDetail\",\r\n  components: { NavBar },\r\n  setup() {\r\n    const route = useRoute();\r\n    const router = useRouter();\r\n    const state = reactive({\r\n      orderId: \"\",\r\n      detail: {\r\n        orderDetails: {\r\n          data: [],\r\n        },\r\n        status: 0,\r\n        order_no: \"\",\r\n        created_at: \"\",\r\n        express_type: \"\",\r\n      },\r\n      showPay: false,\r\n      ali_qr: \"\",\r\n    });\r\n    const init = () => {\r\n      const { id } = route.query;\r\n      state.orderId = id;\r\n      getOrderDetail(id).then((res) => {\r\n        console.log(res);\r\n        state.detail = res;\r\n      });\r\n    };\r\n    onMounted(() => {\r\n      Toast.loading({ message: \"加载中\", forbidClick: true });\r\n      init();\r\n      Toast.clear();\r\n    });\r\n    const payStatus = computed(() => {\r\n      const mapping = {\r\n        1: \"新订单\",\r\n        2: \"支付完成\",\r\n        3: \"已发货\",\r\n        4: \"已确认收货\",\r\n        5: \"已过期\",\r\n      };\r\n      return mapping[state.detail.status];\r\n    });\r\n\r\n    const total = computed(() => {\r\n      let sum = 0;\r\n      state.detail.orderDetails.data.forEach((item) => {\r\n        sum += parseInt(item.num) * parseFloat(item.goods.price);\r\n      });\r\n      return sum;\r\n    });\r\n    const showPayFn = () => {\r\n      state.showPay = true;\r\n      payOrder(state.orderId, { type: \"aliyun\" }).then((res) => {\r\n        state.ali_qr = res.qr_code_url;\r\n      });\r\n      // 轮询请求\r\n      const timer = setInterval(() => {\r\n        payOrderStatus(state.orderId).then((res) => {\r\n          if (res === 2) {\r\n            Toast.success(\"支付成功\");\r\n            state.showPay = false;\r\n            clearInterval(timer);\r\n            init();\r\n          }\r\n        });\r\n      }, 2000);\r\n    };\r\n\r\n    const handleConfirmOrder = () => {\r\n      Dialog.confirm({ title: \"是否确认订单\" }).then(() => {\r\n        confirmOrder(state.orderId).then((res) => {\r\n            Toast.success(\"确认成功\");\r\n            init();\r\n        });\r\n      }).catch(()=> {\r\n\r\n      });\r\n    };\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      payStatus,\r\n      total,\r\n      showPayFn,\r\n      handleConfirmOrder,\r\n    };\r\n  },\r\n};\r\n</script>\r\n \r\n <style lang=\"scss\" scoped>\r\n.detail-box {\r\n  margin-top: 45px;\r\n  text-align: left;\r\n  padding: 0 1em;\r\n\r\n  .text-line {\r\n    padding-bottom: 5px;\r\n    span {\r\n      color: grey;\r\n    }\r\n  }\r\n  .text-line:first-child {\r\n    padding-top: 1em;\r\n  }\r\n\r\n  #confirm-btn {\r\n    border: 0;\r\n    color: black;\r\n    margin-bottom: 10vh;\r\n  }\r\n\r\n  #order {\r\n    margin-bottom: 5vh;\r\n  }\r\n}\r\n</style>","import { render } from \"./OrderDetail.vue?vue&type=template&id=13935f1d&scoped=true\"\nimport script from \"./OrderDetail.vue?vue&type=script&lang=js\"\nexport * from \"./OrderDetail.vue?vue&type=script&lang=js\"\n\nimport \"./OrderDetail.vue?vue&type=style&index=0&id=13935f1d&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-13935f1d\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./OrderDetail.vue?vue&type=style&index=0&id=13935f1d&lang=scss&scoped=true\"","// `Symbol.prototype.description` getter\n// https://tc39.es/ecma262/#sec-symbol.prototype.description\n'use strict';\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar has = require('../internals/has');\nvar isObject = require('../internals/is-object');\nvar defineProperty = require('../internals/object-define-property').f;\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\n\nvar NativeSymbol = global.Symbol;\n\nif (DESCRIPTORS && typeof NativeSymbol == 'function' && (!('description' in NativeSymbol.prototype) ||\n  // Safari 12 bug\n  NativeSymbol().description !== undefined\n)) {\n  var EmptyStringDescriptionStore = {};\n  // wrap Symbol constructor for correct work with undefined description\n  var SymbolWrapper = function Symbol() {\n    var description = arguments.length < 1 || arguments[0] === undefined ? undefined : String(arguments[0]);\n    var result = this instanceof SymbolWrapper\n      ? new NativeSymbol(description)\n      // in Edge 13, String(Symbol(undefined)) === 'Symbol(undefined)'\n      : description === undefined ? NativeSymbol() : NativeSymbol(description);\n    if (description === '') EmptyStringDescriptionStore[result] = true;\n    return result;\n  };\n  copyConstructorProperties(SymbolWrapper, NativeSymbol);\n  var symbolPrototype = SymbolWrapper.prototype = NativeSymbol.prototype;\n  symbolPrototype.constructor = SymbolWrapper;\n\n  var symbolToString = symbolPrototype.toString;\n  var native = String(NativeSymbol('test')) == 'Symbol(test)';\n  var regexp = /^Symbol\\((.*)\\)[^)]+$/;\n  defineProperty(symbolPrototype, 'description', {\n    configurable: true,\n    get: function description() {\n      var symbol = isObject(this) ? this.valueOf() : this;\n      var string = symbolToString.call(symbol);\n      if (has(EmptyStringDescriptionStore, symbol)) return '';\n      var desc = native ? string.slice(7, -1) : string.replace(regexp, '$1');\n      return desc === '' ? undefined : desc;\n    }\n  });\n\n  $({ global: true, forced: true }, {\n    Symbol: SymbolWrapper\n  });\n}\n"],"sourceRoot":""}