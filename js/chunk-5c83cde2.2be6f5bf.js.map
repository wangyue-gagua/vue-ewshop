{"version":3,"sources":["webpack:///./src/views/category/Category.vue","webpack:///./src/network/category.js","webpack:///./src/views/category/Category.vue?3e63","webpack:///./src/views/category/Category.vue?27df"],"names":["class","aria-hidden","xlink:href","id","left","middle","active","active_tab","TabClick","title","activeName","accordion","categories","item","key","name","children","child","getGoods","showGoods","index","goDetail","num","collects_count","tag","price","desc","updated_at","thumb","cover_url","lazy-load","origin-price","bTop","isShowBackTop","getCategory","request","url","getCategoryGoods","order","cid","page","setup","currentOrder","currentId","router","goods","sales","list","comments_count","init","value","then","res","data","bs","scrollTo","document","querySelector","probeType","click","pullUpLoad","on","position","y","console","log","push","finishPullUp","refresh","orders","path","query","components","NavBar","UpBack","render","__scopeId"],"mappings":"sPAIQ,eAEM,OAFDA,MAAM,oBAAoBC,cAAY,Q,CACzC,eAAsC,OAAjCC,aAAW,oB,oBAGI,Q,GAGrBC,GAAG,W,GACDH,MAAM,Y,GA0BNA,MAAM,c,GACJA,MAAM,W,sWAtCjB,eAwDM,YAvDJ,eAOU,QANSI,KAAI,GACnB,iBAEM,CAFN,MAIeC,OAAM,GAAC,iBAAI,C,YAG9B,eA4CM,MA5CN,EA4CM,CA3CJ,eAMM,MANN,EAMM,CALJ,eAIW,GAJOC,OAAQ,EAAAC,W,iDAAA,EAAAA,WAAU,IAAG,QAAO,EAAAC,U,YAC5C,iBAAgC,CAAhC,eAAgC,GAAvBC,MAAM,SACf,eAAgC,GAAvBA,MAAM,SACf,eAAgC,GAAvBA,MAAM,a,+BAInB,eAgBc,G,WAhBQ,EAAAH,O,qDAAA,EAAAA,OAAM,IAAEN,MAAM,Y,YAClC,iBAce,CAdf,eAce,G,WAdQ,EAAAU,W,qDAAA,EAAAA,WAAU,IAAEC,UAAA,I,YAE/B,iBAA0B,E,mBAD5B,eAYoB,2BAXH,EAAAC,YAAU,SAAlBC,G,wBADT,eAYoB,GAVjBC,IAAKD,EAAKV,GACVM,MAAOI,EAAKE,KACZA,KAAMF,EAAKV,I,YAGV,iBAA8B,E,mBADhC,eAKE,2BAJgBU,EAAKG,UAAQ,SAAtBC,G,wBADT,eAKE,GAHCH,IAAKG,EAAMd,GACXM,MAAOQ,EAAMF,KACb,QAAK,mBAAE,EAAAG,SAASD,EAAMd,M,oIAM/B,eAgBM,MAhBN,EAgBM,CAfJ,eAcM,MAdN,EAcM,E,mBAbJ,eAYE,2BAVwB,EAAAgB,WAAS,SAAzBN,EAAMO,G,wBAFhB,eAYE,GAXC,QAAK,mBAAE,EAAAC,SAASR,EAAKV,KAErBW,IAAKM,EACLE,IAAKT,EAAKU,eACVC,IAAKX,EAAKU,gBAAc,cACxBE,MAAOZ,EAAKY,MACZC,KAAMb,EAAKc,WACXlB,MAAOI,EAAKJ,MACZmB,MAAOf,EAAKgB,UACZC,aAAW,EACZC,eAAa,S,6FAKrB,eAAuD,GAAtB,OAAM,EAAAC,MAAI,oB,QAA1B,EAAAC,sB,gDCtDd,SAASC,IACZ,OAAOC,eAAQ,CACXC,IAAK,eAIN,SAASC,IAA+C,IAA9BC,EAA8B,uDAAxB,QAASC,EAAe,uDAAX,EAAGC,EAAQ,uDAAH,EACxD,OAAOL,eAAQ,CACXC,IAAK,0BAA0BG,EAAI,IAAID,EAAlC,WAAsDE,I,4BDyDpD,GACbC,MADa,WAEX,IAAMnC,EAAS,eAAI,GACfM,EAAa,eAAI,IACjBF,EAAa,eAAI,KACjBH,EAAa,eAAI,GACjBmC,EAAe,eAAI,SACnBC,EAAY,eAAI,GAChBV,EAAgB,gBAAI,GACpBW,EAAS,iBAEPC,EAAQ,eAAS,CACrBC,MAAO,CAAEN,KAAM,EAAGO,KAAM,IACxBtB,MAAO,CAAEe,KAAM,EAAGO,KAAM,IACxBC,eAAgB,CAAER,KAAM,EAAGO,KAAM,MAE7BE,EAAO,WACXZ,EAAiB,QAASM,EAAUO,OAAOC,MAAK,SAACC,GAC/CP,EAAMC,MAAMC,KAAOK,EAAIP,MAAMQ,QAG/BhB,EAAiB,QAASM,EAAUO,OAAOC,MAAK,SAACC,GAC/CP,EAAMpB,MAAMsB,KAAOK,EAAIP,MAAMQ,QAG/BhB,EAAiB,iBAAkBM,EAAUO,OAAOC,MAAK,SAACC,GACxDP,EAAMG,eAAeD,KAAOK,EAAIP,MAAMQ,SAIpCrB,EAAO,WACXsB,EAAGC,SAAS,EAAG,EAAG,MAGhBD,EAAK,eAAS,IAElB,gBAAU,WACRpB,IAAciB,MAAK,SAACC,GAClBxC,EAAWsC,MAAQE,EAAIxC,cAGzByB,EAAiB,QAASM,EAAUO,OAAOC,MAAK,SAACC,GAC/CP,EAAMC,MAAMC,KAAOK,EAAIP,MAAMQ,QAG/BC,EAAK,IAAI,OAAQE,SAASC,cAAc,eAAgB,CAEtDC,UAAW,EACXC,OAAO,EACPC,YAAY,IAMdN,EAAGO,GAAG,UAAU,SAACC,GACf7B,EAAciB,OAASY,EAASC,EAAI,OAGtCT,EAAGO,GAAG,aAAa,WACjBG,QAAQC,IAAI,sBACZ,IAAIzB,EAAOK,EAAMH,EAAaQ,OAAOV,KAAO,EAC5CH,EAAiBK,EAAaQ,MAAOP,EAAUO,MAAOV,GAAMW,MAC1D,SAACC,GAAQ,OACP,EAAAP,EAAMH,EAAaQ,OAAOH,MAAKmB,KAA/B,uBAAuCd,EAAIP,MAAMQ,OACjDR,EAAMH,EAAaQ,OAAOV,MAAQ,KAItCc,EAAGa,eACHb,GAAMA,EAAGc,UACTJ,QAAQC,IAAI,gBAAkBzB,SAIlC,IAAMrB,EAAY,gBAAS,WACzB,OAAO0B,EAAMH,EAAaQ,OAAOH,QAG7BvC,EAAW,SAACY,GAChB,IAAIiD,EAAS,CAAC,QAAS,QAAS,kBAChC3B,EAAaQ,MAAQmB,EAAOjD,GAC5BiB,EAAiBK,EAAaQ,MAAOP,EAAUO,OAAOC,MAAK,SAACC,GAC1DP,EAAMH,EAAaQ,OAAOH,KAAOK,EAAIP,MAAMQ,KAC3C,gBAAS,WACPC,GAAMA,EAAGc,gBAIbJ,QAAQC,IAAII,EAAOjD,KAGfF,EAAW,SAACf,GAChBwC,EAAUO,MAAQ/C,EAClB8C,IACAe,QAAQC,IAAItB,IASd,OANA,gBAAY,WACV,gBAAS,WACPW,GAAMA,EAAGc,gBAIN,CACL9D,SACAI,aACAH,aACAK,aACAJ,WACAU,WACAC,YACAmC,KACAtB,OACAC,gBACAZ,SAAU,SAAClB,GACTyC,EAAOsB,KAAK,CACVI,KAAM,UACNC,MAAO,CAAEpE,WAKjBqE,WAAY,CACVC,SAAA,KACAC,SAAA,O,UE3LJ,EAAOC,OAASA,EAChB,EAAOC,UAAY,kBAEJ,gB,kCCRf","file":"js/chunk-5c83cde2.2be6f5bf.js","sourcesContent":["<template>\r\n  <div>\r\n    <nav-bar>\r\n      <template v-slot:left>\r\n        <svg class=\"icon tab-bar-icon\" aria-hidden=\"true\">\r\n          <use xlink:href=\"#icon-jiantou\"></use>\r\n        </svg>\r\n      </template>\r\n      <template v-slot:middle>商品分类</template>\r\n    </nav-bar>\r\n\r\n    <div id=\"mainbox\">\r\n      <div class=\"ordertab\">\r\n        <van-tabs v-model:active=\"active_tab\" @click=\"TabClick\">\r\n          <van-tab title=\"销量排序\"></van-tab>\r\n          <van-tab title=\"价格排序\"></van-tab>\r\n          <van-tab title=\"评价排序\"></van-tab>\r\n        </van-tabs>\r\n      </div>\r\n\r\n      <van-sidebar v-model=\"active\" class=\"leftmenu\">\r\n        <van-collapse v-model=\"activeName\" accordion>\r\n          <van-collapse-item\r\n            v-for=\"item of categories\"\r\n            :key=\"item.id\"\r\n            :title=\"item.name\"\r\n            :name=\"item.id\"\r\n          >\r\n            <van-sidebar-item\r\n              v-for=\"child of item.children\"\r\n              :key=\"child.id\"\r\n              :title=\"child.name\"\r\n              @click=\"getGoods(child.id)\"\r\n            />\r\n          </van-collapse-item>\r\n        </van-collapse>\r\n      </van-sidebar>\r\n\r\n      <div class=\"goods-list\">\r\n        <div class=\"content\">\r\n          <van-card\r\n            @click=\"goDetail(item.id)\"\r\n            v-for=\"(item, index) of showGoods\"\r\n            :key=\"index\"\r\n            :num=\"item.collects_count\"\r\n            :tag=\"item.collects_count >= 3 ? 'hot' : 'new'\"\r\n            :price=\"item.price\"\r\n            :desc=\"item.updated_at\"\r\n            :title=\"item.title\"\r\n            :thumb=\"item.cover_url\"\r\n            :lazy-load=\"true\"\r\n            origin-price=\"10.00\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <up-back v-show=\"isShowBackTop\" @bTop=\"bTop\"></up-back>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from \"components/common/navbar/NavBar.vue\";\r\nimport UpBack from \"components/common/upback/UpBack.vue\";\r\nimport { getCategory, getCategoryGoods } from \"network/category.js\";\r\nimport { ref, reactive, onMounted, computed, watchEffect, nextTick } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport BScroll from \"better-scroll\";\r\nexport default {\r\n  setup() {\r\n    const active = ref(0);\r\n    let categories = ref([]);\r\n    let activeName = ref(\"1\");\r\n    let active_tab = ref(0);\r\n    let currentOrder = ref(\"sales\");\r\n    let currentId = ref(0);\r\n    let isShowBackTop = ref(false);\r\n    let router = useRouter();\r\n    // data model\r\n    const goods = reactive({\r\n      sales: { page: 1, list: [] },\r\n      price: { page: 1, list: [] },\r\n      comments_count: { page: 1, list: [] },\r\n    });\r\n    const init = () => {\r\n      getCategoryGoods(\"sales\", currentId.value).then((res) => {\r\n        goods.sales.list = res.goods.data;\r\n      });\r\n\r\n      getCategoryGoods(\"price\", currentId.value).then((res) => {\r\n        goods.price.list = res.goods.data;\r\n      });\r\n\r\n      getCategoryGoods(\"comments_count\", currentId.value).then((res) => {\r\n        goods.comments_count.list = res.goods.data;\r\n      });\r\n    };\r\n\r\n    const bTop = () => {\r\n      bs.scrollTo(0, 0, 500);\r\n    };\r\n\r\n    let bs = reactive({});\r\n\r\n    onMounted(() => {\r\n      getCategory().then((res) => {\r\n        categories.value = res.categories;\r\n      });\r\n\r\n      getCategoryGoods(\"sales\", currentId.value).then((res) => {\r\n        goods.sales.list = res.goods.data;\r\n      });\r\n\r\n      bs = new BScroll(document.querySelector(\".goods-list\"), {\r\n        // ...\r\n        probeType: 3,\r\n        click: true,\r\n        pullUpLoad: true,\r\n        // wheel: true,\r\n        // scrollbar: true,\r\n        // and so on\r\n      });\r\n      // register scroll event\r\n      bs.on(\"scroll\", (position) => {\r\n        isShowBackTop.value = -position.y > 300;\r\n      });\r\n      // pullingUp for more data info\r\n      bs.on(\"pullingUp\", () => {\r\n        console.log(\"pullingUp for more\");\r\n        let page = goods[currentOrder.value].page + 1;\r\n        getCategoryGoods(currentOrder.value, currentId.value, page).then(\r\n          (res) => {\r\n            goods[currentOrder.value].list.push(...res.goods.data);\r\n            goods[currentOrder.value].page += 1;\r\n          }\r\n        );\r\n        // finish pullingUp and present data info\r\n        bs.finishPullUp();\r\n        bs && bs.refresh();\r\n        console.log(\"current page:\" + page);\r\n      });\r\n    });\r\n\r\n    const showGoods = computed(() => {\r\n      return goods[currentOrder.value].list;\r\n    });\r\n    // sort tabs\r\n    const TabClick = (index) => {\r\n      let orders = [\"sales\", \"price\", \"comments_count\"];\r\n      currentOrder.value = orders[index];\r\n      getCategoryGoods(currentOrder.value, currentId.value).then((res) => {\r\n        goods[currentOrder.value].list = res.goods.data;\r\n        nextTick(() => {\r\n          bs && bs.refresh();\r\n        });\r\n      });\r\n\r\n      console.log(orders[index]);\r\n    };\r\n    // get goods by category\r\n    const getGoods = (id) => {\r\n      currentId.value = id;\r\n      init();\r\n      console.log(currentId);\r\n    };\r\n\r\n    watchEffect(() => {\r\n      nextTick(() => {\r\n        bs && bs.refresh();\r\n      });\r\n    });\r\n\r\n    return {\r\n      active,\r\n      activeName,\r\n      active_tab,\r\n      categories,\r\n      TabClick,\r\n      getGoods,\r\n      showGoods,\r\n      bs,\r\n      bTop,\r\n      isShowBackTop,\r\n      goDetail: (id) => {\r\n        router.push({\r\n          path: \"/detail\",\r\n          query: { id },\r\n        });\r\n      },\r\n    };\r\n  },\r\n  components: {\r\n    NavBar,\r\n    UpBack,\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n#mainbox {\r\n  margin-top: 45px;\r\n  display: flex;\r\n  .ordertab {\r\n    flex: 1;\r\n    float: right;\r\n    // background-color: red;\r\n    height: 50px;\r\n    z-index: 9;\r\n    position: fixed;\r\n    top: 45px;\r\n    left: 130px;\r\n    right: 0;\r\n  }\r\n\r\n  .leftmenu {\r\n    width: 130px;\r\n    // background-color: yellow;\r\n    position: fixed;\r\n    top: 95px;\r\n    left: 0;\r\n  }\r\n\r\n  .goods-list {\r\n    height: 100vh;\r\n    flex: 1;\r\n    // background-color: blue;\r\n    position: absolute;\r\n    top: 100px;\r\n    left: 130px;\r\n    right: 0;\r\n  }\r\n}\r\n</style>","import {request} from './request'\r\n\r\nexport function getCategory() {\r\n    return request({\r\n        url: '/api/goods', \r\n    })\r\n}\r\n\r\nexport function getCategoryGoods(order='sales', cid=0, page=1) {\r\n    return request({\r\n        url: '/api/goods?category_id='+cid+'&'+order+\"=1\"+'&page='+page, \r\n    })\r\n}","import { render } from \"./Category.vue?vue&type=template&id=7c7eeb2c&scoped=true\"\nimport script from \"./Category.vue?vue&type=script&lang=js\"\nexport * from \"./Category.vue?vue&type=script&lang=js\"\n\nimport \"./Category.vue?vue&type=style&index=0&id=7c7eeb2c&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-7c7eeb2c\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Category.vue?vue&type=style&index=0&id=7c7eeb2c&scoped=true&lang=scss\""],"sourceRoot":""}